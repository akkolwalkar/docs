(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{233:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"stake-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stake-management"}},[s._v("#")]),s._v(" Stake Management")]),s._v(" "),t("p",[s._v("For node operators the "),t("code",[s._v("oasis-node")]),s._v(" binary offers a command line interface for\nvarious staking token operations.")]),s._v(" "),t("p",[s._v("The following commands are intended to be run "),t("strong",[s._v("online")]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("oasis-node stake info")]),s._v(" shows the token information,")]),s._v(" "),t("li",[t("code",[s._v("oasis-node stake list")]),s._v(" lists all accounts with positive balance,")]),s._v(" "),t("li",[t("code",[s._v("oasis-node stake account info")]),s._v(" shows detailed account information,")]),s._v(" "),t("li",[t("code",[s._v("oasis-node consensus submit_tx")]),s._v(" submits a pregenerated transaction given a\nfilename.")])]),s._v(" "),t("p",[s._v("In addition, the following commands generate transactions and are meant to be\nrun offline, because signing transactions requires a private key which "),t("strong",[s._v("should\nnot be accessible")]),s._v(" from outside in any way:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("oasis-node stake account gen_transfer")])]),s._v(" "),t("li",[t("code",[s._v("oasis-node stake account gen_burn")])]),s._v(" "),t("li",[t("code",[s._v("oasis-node stake account gen_escrow")])]),s._v(" "),t("li",[t("code",[s._v("oasis-node stake account gen_reclaim_escrow")])])]),s._v(" "),t("h2",{attrs:{id:"staking-basics"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#staking-basics"}},[s._v("#")]),s._v(" Staking basics")]),s._v(" "),t("p",[s._v("We will assume you followed previous node operators sections so you have "),t("code",[s._v("oasis-node")]),s._v("\nbinary available, a genesis file location stored in an environmental variable "),t("code",[s._v("$GENESIS_FILE_PATH")]),s._v(",\nand the private keypair of your entity in a directory "),t("code",[s._v("$ENTITY_DIR_PATH")]),s._v(".\nAdditionally, we will use "),t("code",[s._v("$ADDR")]),s._v(" containing the location of the internal socket,\nof the Oasis node, for example")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unix:/tmp/oasis-net-runner236357163/net-runner/network/client-0/internal.sock\n")])])]),t("p",[s._v("We will provide the "),t("code",[s._v("-a $ADDR")]),s._v(" parameter to any operation which requires\nconnection to the Oasis node. Conversely, "),t("code",[s._v("--genesis.file $GENESIS_FILE_PATH")]),s._v("\nand "),t("code",[s._v("--signer.dir $ENTITY_DIR_PATH")]),s._v(" will be used for offline operations.")]),s._v(" "),t("p",[s._v("The "),t("code",[s._v("--signer")]),s._v(" flag is used to determine the backend used to sign transactions\nfor offline operations.")]),s._v(" "),t("ul",[t("li",[s._v("For a file based signer, use "),t("code",[s._v("--signer file")]),s._v(" and include the keys in\n"),t("code",[s._v("$ENTITY_DIR_PATH")]),s._v(". This is set by default, but is included in all examples to\nbe explicit.")]),s._v(" "),t("li",[s._v("For a Ledger based signer, use "),t("code",[s._v("--signer ledger")]),s._v(" to indicate the use of a\nLedger device, "),t("code",[s._v("--signer.ledger.address")]),s._v(" to specify the device by address, and\n"),t("code",[s._v("--signer.ledger.index")]),s._v(" to specify the address index for the derivation path.")])]),s._v(" "),t("p",[s._v("First, let's check out the native token of our platform:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node stake info -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v("\nName: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Buffycoin"')]),s._v("\nSymbol: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"BUF"')]),s._v("\nTotal supply: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200000000000")]),s._v("\nCommon pool: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nStaking threshold "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("entity"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nStaking threshold "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("validator"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nStaking threshold "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("compute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nStaking threshold "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("storage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("There is a native token named "),t("code",[s._v("Buffycoin")]),s._v(" with symbol "),t("code",[s._v("BUF")]),s._v(" with total supply of\n200 billion. All tokens are allocated in their respective accounts and no tokens\nare in the "),t("em",[s._v("common pool")]),s._v(". Finally we see no staking thresholds for any node kind\n(entity, validator, compute, storage).")]),s._v(" "),t("p",[s._v("Let's list all accounts with positive balance:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node stake list -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v("\n4ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35\n")])])]),t("p",[s._v("There exists one such account "),t("code",[s._v("4ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35")]),s._v(".\nFor more information about the account, run:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node stake account info "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --stake.account.id 4ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("We notice that:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("id")]),s._v(" stores the Base64-encoded address of the account.")]),s._v(" "),t("li",[t("code",[s._v("general_balance")]),s._v(" is the number of tokens which can be spent by a transfer\ntransaction signed by the account's private key.")]),s._v(" "),t("li",[s._v("Each account can also serve as an escrow. "),t("code",[s._v("escrow_balance")]),s._v(" is the number of\ntokens this account contains as an escrow and which can be reclaimed by the\ndepositor. In our environment, both balances have 100 billion tokens.")]),s._v(" "),t("li",[s._v("Any outgoing transaction from the account must have an incremental "),t("code",[s._v("nonce")]),s._v(". In\nour case, the next outgoing transaction of the account should have "),t("code",[s._v("nonce: 0")]),s._v(".")])]),s._v(" "),t("h2",{attrs:{id:"example-burning-tokens"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-burning-tokens"}},[s._v("#")]),s._v(" Example: Burning tokens")]),s._v(" "),t("p",[s._v("Next, we will generate and sign our first transaction. Let's start with a "),t("em",[s._v("burn")]),s._v("\ntransaction, which destroys the given number of tokens. To generate a\nburn transaction of 2000 tokens, sign and store the transaction to file "),t("code",[s._v("b.json")]),s._v(",\ntype:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node stake account gen_burn "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --genesis.file "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GENESIS_FILE_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer.dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENTITY_DIR_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.file b.json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.nonce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.gas "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("We used the following parameters:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--stake.transaction.amount")]),s._v(" specifying the number of tokens,")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.file")]),s._v(" the output filename of the transaction stored in\nJSON format,")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.nonce")]),s._v(" the incremental nonce. Since this is our first\ntransaction which changes the account balance, "),t("code",[s._v("nonce")]),s._v(" equals "),t("code",[s._v("0")]),s._v(",")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.fee.gas")]),s._v(" is the maximum amount of gas we allow this\ntransaction to spend,")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.fee.amount")]),s._v(" is the fee in tokens we will pay for this\ntransaction.")])]),s._v(" "),t("p",[s._v("The above generation and signing of the transaction can be done offline.")]),s._v(" "),t("p",[s._v("To submit our transaction, we need to copy "),t("code",[s._v("b.json")]),s._v(" to a location accessible by\nthe online Oasis node (e.g. via ssh) and run on the server:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node consensus submit_tx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --transaction.file b.json\n")])])]),t("p",[s._v("Beside the node's address, the submit operation above requires:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--transaction.file")]),s._v(" is the input filename of the transaction,")])]),s._v(" "),t("p",[s._v("Finally, let's check the new balance of the account:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node stake account info "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --stake.account.id 4ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99999998000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("Notice that "),t("code",[s._v("2000")]),s._v(" tokens have been correctly deducted from the "),t("code",[s._v("general_balance")]),s._v(".")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),t("p",[s._v("Usually, the new balance is seen immediately, but some transactions (for example\nescrow reclaiming) do not take effect until after a debonding period has elapsed,\nso you might need to wait a few blocks for the balances to update.")])]),s._v(" "),t("h2",{attrs:{id:"example-transferring-tokens"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-transferring-tokens"}},[s._v("#")]),s._v(" Example: Transferring tokens")]),s._v(" "),t("p",[s._v("Token transfer transactions transfer tokens from the signer's account to the\ngiven destination account. Let's generate a transfer transaction of 1000 tokens\nto account "),t("code",[s._v("5ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node stake account gen_transfer "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --genesis.file "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GENESIS_FILE_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer.dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENTITY_DIR_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.file t.json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.nonce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transfer.destination 5ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.gas "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("We used similar parameters to the ones used for generating the burn transaction:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--stake.transaction.amount")]),s._v(" is the number of tokens to transfer,")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.file")]),s._v(" is the output filename,")]),s._v(" "),t("li",[t("code",[s._v("--stake.transaction.nonce")]),s._v(" is the incremental nonce. In our case, this is the\nsecond transaction on the account, thus "),t("code",[s._v("nonce")]),s._v(" equals "),t("code",[s._v("1")]),s._v(",")]),s._v(" "),t("li",[t("code",[s._v("--stake.transfer.destination")]),s._v(" is a hex-encoded address of the receiving\naccount of tokens.")])]),s._v(" "),t("p",[s._v("Let's submit the transaction stored in "),t("code",[s._v("t.json")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node consensus submit_tx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --transaction.file t.json\n")])])]),t("p",[s._v("Finally let's list all the accounts and their balances by adding "),t("code",[s._v("-v")]),s._v(" flag for\nincreased verbosity:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node stake list -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" -v\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99999997000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"XqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("Notice another 1000 tokens have been deducted from the first account and\ntransferred to the second one.")]),s._v(" "),t("h2",{attrs:{id:"example-escrowing-tokens-and-reclaiming-them"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-escrowing-tokens-and-reclaiming-them"}},[s._v("#")]),s._v(" Example: Escrowing tokens and reclaiming them")]),s._v(" "),t("p",[s._v("In the third example we will put 3000 tokens to an escrow account\n"),t("code",[s._v("6ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35")]),s._v(" and then\nreclaim them. First, let's generate an escrow transaction and store it to "),t("code",[s._v("e.json")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node stake account gen_escrow "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --genesis.file "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GENESIS_FILE_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer.dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENTITY_DIR_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.file e.json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.nonce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.escrow.account 6ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.gas "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("Let's submit the escrow transaction and list the accounts:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node consensus submit_tx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --transaction.file e.json\n$ oasis-node stake list -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" -v\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99999994000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"XqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("Notice 3000 tokens have been deducted from the first account's "),t("code",[s._v("general_balance")]),s._v("\nand added to an "),t("code",[s._v("escrow_balance")]),s._v(" of the third account.")]),s._v(" "),t("p",[s._v("We reclaim 3000 escrowed tokens by generating the reclaim escrow transaction:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("oasis-node stake account gen_reclaim_escrow "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --genesis.file "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GENESIS_FILE_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --signer.dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENTITY_DIR_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.file r.json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.nonce "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.escrow.account 6ea5328f943ef6f66daaed74cb0e99c3b1c45f76307b425003dbc7cb3638ed35 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.gas "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --stake.transaction.fee.amount "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("Let's submit it and in a few moments list the accounts:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ oasis-node consensus submit_tx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --transaction.file r.json\n$ oasis-node stake list -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDR")]),s._v(" -v\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99999997000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100000000000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"XqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bqUyj5Q+9vZtqu10yw6Zw7HEX3Ywe0JQA9vHyzY47TU="')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"escrow_balance"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nonce"')]),s._v(":0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("Notice 3000 tokens have been reclaimed by the first account from the third\naccount's "),t("code",[s._v("escrow_balance")]),s._v(". The "),t("code",[s._v("general_balance")]),s._v(" of the first account was\ncorrectly updated and the "),t("code",[s._v("escrow_balance")]),s._v(" of the third account is now empty.")])])}),[],!1,null,null,null);a.default=e.exports}}]);